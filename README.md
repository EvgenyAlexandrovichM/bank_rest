# üìò Card Management API

API‚Äë—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –∫–∞—Ä—Ç–∞–º–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏.  
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (JWT), –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–∞—Ä—Ç–∞–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, –ø–µ—Ä–µ–≤–æ–¥—ã), –∞ —Ç–∞–∫–∂–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (JWT)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∞–º–∏: —Å–æ–∑–¥–∞–Ω–∏–µ, –∞–∫—Ç–∏–≤–∞—Ü–∏—è, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ
- –ü–µ—Ä–µ–≤–æ–¥—ã –º–µ–∂–¥—É –∫–∞—Ä—Ç–∞–º–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –±–∞–ª–∞–Ω—Å–∞
- –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`ROLE_USER`, `ROLE_ADMIN`)
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenAPI/Swagger

---

## üìÇ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- Java 17
- Spring Boot 3.1.6 (Web, Security, Data JPA, Validation)
- PostgreSQL 15
- Liquibase 5.0.1
- Docker 27.x + Docker Compose v2.x
- JUnit 5, Mockito 5
- Lombok 1.18.28
- MapStruct 1.5.5.Final
- Springdoc OpenAPI 2.1.0

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –∏ Docker Compose
- JDK 17 (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤)
- Maven

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- src/main/java ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

- src/main/resources ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Ä–µ—Å—É—Ä—Å—ã (application.yml, Liquibase)

- src/test/java ‚Äî –º–æ–¥—É–ª—å–Ω—ã–µ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

- docs/ ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (OpenAPI)

- docker-compose.yml ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ë–î

- .env ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞
- ---

## üîë –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è                  | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                          |
|------------------------------|----------------------------------------------------|
| `SPRING_DATASOURCE_URL`      | —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL                    |
| `SPRING_DATASOURCE_USERNAME` | –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î                                |
| `SPRING_DATASOURCE_PASSWORD` | –ø–∞—Ä–æ–ª—å –ë–î                                          |
| `ADMIN_PASSWORD_BCRYPT`      | bcrypt‚Äë—Ö—ç—à –ø–∞—Ä–æ–ª—è –¥–ª—è —Å–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |
| `JWT_SECRET_BASE64`          | —Å–µ–∫—Ä–µ—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT (base64)                    |
| `CARD_ENCRYPTION_KEY_BASE64` | –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –∫–∞—Ä—Ç (base64)          |
| `JWT_EXPIRATION_MS`          | –≤—Ä–µ–º—è

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
### 1. –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/EvgenyAlexandrovichM/bank_rest.git
cd bank_rest
```

### 2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª .env –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–º. —Ç–∞–±–ª–∏—Ü—É –≤—ã—à–µ).

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç:

- –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose
```bash
docker-compose up --build
```

- –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ
```bash
mvn clean package -DskipTests
java -jar target/card-service-0.0.1-SNAPSHOT.jar
```

‚ö†Ô∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ `docker-compose` –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `.env`.  
–ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ (`java -jar ...`) –∏—Ö –Ω—É–∂–Ω–æ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é –≤ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ PowerShell –∏–ª–∏ Bash), –∏–Ω–∞—á–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å `JwtServiceImpl` –∏ —É–ø–∞–¥—ë—Ç —Å –æ—à–∏–±–∫–æ–π `WeakKeyException`.

---

## üìë –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

- OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: docs/openapi.yaml

- Swagger UI: http://localhost:8080/swagger-ui.html

---

## üë§ –î–æ—Å—Ç—É–ø—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- username: admin

- password: —Å–º. –∑–Ω–∞—á–µ–Ω–∏–µ ADMIN_PASSWORD_BCRYPT –≤ .env (bcrypt‚Äë—Ö—ç—à)

---
## üìå –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### üîê –í—Ö–æ–¥

```bash
curl -X POST http://localhost:8080/api/auth/login \
-H "Content-Type: application/json" \
-d '{"username":"user","password":"P@ssw0rd!"}'
```

### üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

```bash
curl -X POST http://localhost:8080/api/auth/register \
-H "Content-Type: application/json" \
-d '{"username":"newuser","password":"P@ssw0rd!"}'
```

### üí≥ –ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É –∫–∞—Ä—Ç–∞–º–∏

```bash
curl -X POST http://localhost:8080/api/cards/transfer \
-H "Authorization: Bearer <JWT>" \
-H "Content-Type: application/json" \
-d '{"fromCardId":1,"toCardId":2,"amount":100.00,"description":"Test transfer"}'
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
mvn test
```
---


